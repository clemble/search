machine:
  java:
    version: oraclejdk8
  services:
    - docker
    - elasticsearch
    - rabbitmq-server

dependencies:
  override:
    - rm -rf ~/.m2/repository/com/clemble
    - mvn install

deployment:
  hub:
    branch: master
    commands:
      - mvn deploy
      - docker info
      - docker build -t clemble/search .
      - docker login -e $DOCKER_EMAIL -u $DOCKER_USER -p $DOCKER_PASS
      - docker push clemble/social